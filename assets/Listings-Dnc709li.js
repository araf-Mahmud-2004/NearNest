import{j as e}from"./ui-JykPZCXU.js";import{r as i}from"./vendor-o8UMtg5z.js";import{I as T,B as x}from"./input-Y27Ukfeg.js";import{S as h,a as g,b as p,c as f,d as r}from"./select-Dk-cLJJQ.js";import{N as _,S as j,L as E,e as k}from"./Navbar-DN0c9AM8.js";import{G as B,P}from"./PostCard-_Ags_evD.js";import{a as A}from"./ErrorBoundary-B3hxSvuK.js";import{d as V,u as F}from"./index-Xla51Co3.js";import{a as I}from"./router-CRfqy20j.js";import"./index-BdQq_4o_.js";import"./card-D3n9XfdJ.js";import"./textarea-DgS_dI9E.js";import"./label-B4bWfWXI.js";import"./useMessaging-aOjBx_76.js";import"./timeUtils-B3Mv27P7.js";import"./utils-Bsf8JV-l.js";import"./map-pin-DS8IMhAL.js";import"./clock-BM4GInVb.js";import"./eye-DKcQtfPS.js";import"./supabase-DllsxF6L.js";const ae=()=>{const{listings:N,loading:o,deleteListing:w}=V();F();const y=I(),[l,v]=i.useState(""),[n,S]=i.useState("all"),[m,b]=i.useState("newest"),[c,u]=i.useState("grid"),C=["all","Electronics","Furniture","Clothing","Books","Sports","Other"],D=t=>{y(`/edit-listing/${t}`)},L=async t=>{window.confirm("Are you sure you want to delete this listing?")&&await w(t)},a=N.filter(t=>{try{const s=t.title.toLowerCase().includes(l.toLowerCase())||t.description.toLowerCase().includes(l.toLowerCase()),d=n==="all"||t.category===n;return s&&d}catch(s){return console.error("Error filtering listing:",s),!1}}).sort((t,s)=>{try{switch(m){case"price-low":return(t.price||0)-(s.price||0);case"price-high":return(s.price||0)-(t.price||0);case"newest":return new Date(s.created_at||0).getTime()-new Date(t.created_at||0).getTime();case"oldest":return new Date(t.created_at||0).getTime()-new Date(s.created_at||0).getTime();default:return new Date(s.created_at||0).getTime()-new Date(t.created_at||0).getTime()}}catch(d){return console.error("Error sorting listings:",d),0}});return e.jsxs("div",{className:"min-h-screen bg-background text-foreground",children:[e.jsx(_,{}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8 animate-fade-in",children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Marketplace"}),e.jsx("p",{className:"text-muted-foreground",children:"Discover great deals from your neighbors"})]}),e.jsx("div",{className:"bg-card rounded-lg shadow-sm border border-border p-6 mb-8 animate-fade-in",style:{animationDelay:"0.1s"},children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(j,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(T,{placeholder:"Search listings...",value:l,onChange:t=>v(t.target.value),className:"pl-10"})]}),e.jsxs(h,{value:n,onValueChange:S,children:[e.jsx(g,{children:e.jsx(p,{placeholder:"Category"})}),e.jsx(f,{children:C.map(t=>e.jsx(r,{value:t,children:t==="all"?"All Categories":t},t))})]}),e.jsxs(h,{value:m,onValueChange:b,children:[e.jsx(g,{children:e.jsx(p,{placeholder:"Sort by"})}),e.jsxs(f,{children:[e.jsx(r,{value:"newest",children:"Newest First"}),e.jsx(r,{value:"oldest",children:"Oldest First"}),e.jsx(r,{value:"price-low",children:"Price: Low to High"}),e.jsx(r,{value:"price-high",children:"Price: High to Low"})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(x,{variant:c==="grid"?"default":"outline",size:"sm",onClick:()=>u("grid"),className:"flex-1 transition-all duration-200",children:e.jsx(B,{className:"h-4 w-4"})}),e.jsx(x,{variant:c==="list"?"default":"outline",size:"sm",onClick:()=>u("list"),className:"flex-1 transition-all duration-200",children:e.jsx(E,{className:"h-4 w-4"})})]})]})}),e.jsx("div",{className:"mb-6 animate-fade-in",style:{animationDelay:"0.2s"},children:e.jsxs("p",{className:"text-muted-foreground",children:[a.length," listing",a.length!==1?"s":""," found"]})}),o&&e.jsxs("div",{className:"flex justify-center items-center py-12",children:[e.jsx(k,{className:"h-8 w-8 animate-spin"}),e.jsx("span",{className:"ml-2 text-muted-foreground",children:"Loading listings..."})]}),!o&&e.jsx("div",{className:`animate-fade-in transition-all duration-300 ${c==="grid"?"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6":"space-y-4"}`,style:{animationDelay:"0.3s"},children:a.map((t,s)=>e.jsx(A,{fallback:e.jsx("div",{className:"p-4 border rounded-lg bg-muted/50",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Unable to load this listing"})}),children:e.jsx(P,{id:t.id,title:t.title,description:t.description,location:t.location,category:t.category,image:t.image,price:t.price,timeAgo:t.timeAgo,created_at:t.created_at,user_id:t.user_id,profiles:t.profiles,onEdit:D,onDelete:L,type:"listing"})},t.id))}),a.length===0&&!o&&e.jsxs("div",{className:"text-center py-12 animate-fade-in",style:{animationDelay:"0.3s"},children:[e.jsx("div",{className:"text-muted-foreground mb-4",children:e.jsx(j,{className:"h-12 w-12 mx-auto"})}),e.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"No listings found"}),e.jsx("p",{className:"text-muted-foreground",children:"Try adjusting your search criteria"})]})]})]})};export{ae as default};
