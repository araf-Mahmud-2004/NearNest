import{j as e}from"./ui-JykPZCXU.js";import{r as d}from"./vendor-o8UMtg5z.js";import{b as P,u as S,s as k,p as E}from"./index-ChpuFEIP.js";import{B as N,I as i}from"./input-djnnCoEv.js";import"./supabase-DllsxF6L.js";import"./utils-Bsf8JV-l.js";import"./router-DZ6VJzti.js";const D=()=>{const{user:o,profile:a,refreshProfile:b}=P(),{toast:m}=S(),x=d.useRef(null),[t,u]=d.useState({full_name:a?.full_name||"",email:o?.email||"",bio:a?.bio||"",avatar_url:a?.avatar_url||"",location:a?.location||"",twitter:a?.twitter||"",linkedin:a?.linkedin||"",facebook:a?.facebook||"",website:a?.website||""}),[c,n]=d.useState(!1),[p,h]=d.useState(t.avatar_url);if(d.useEffect(()=>{u({full_name:a?.full_name||"",email:o?.email||"",bio:a?.bio||"",avatar_url:a?.avatar_url||"",location:a?.location||"",twitter:a?.twitter||"",linkedin:a?.linkedin||"",facebook:a?.facebook||"",website:a?.website||""}),h(a?.avatar_url||"")},[a,o]),!o)return null;const r=s=>{u({...t,[s.target.name]:s.target.value})},y=async s=>{const l=s.target.files?.[0];if(!l)return;const v=new FileReader;v.onload=f=>{h(f.target?.result)},v.readAsDataURL(l),n(!0);const C=l.name.split(".").pop(),g=`avatar/${o.id}.${C}`,{error:j}=await k.storage.from("avatar").upload(g,l,{upsert:!0});if(j){m({title:"Avatar Upload Failed",description:j.message,variant:"destructive"}),n(!1);return}const{data:w}=k.storage.from("avatar").getPublicUrl(g);w?.publicUrl&&u(f=>({...f,avatar_url:w.publicUrl})),n(!1)},_=async s=>{s.preventDefault(),n(!0);const{error:l}=await E.updateProfile(o.id,{full_name:t.full_name,bio:t.bio,avatar_url:t.avatar_url,location:t.location,twitter:t.twitter,linkedin:t.linkedin,facebook:t.facebook,website:t.website});n(!1),l?m({title:"Error",description:l,variant:"destructive"}):(m({title:"Profile updated!",description:"Your profile was updated successfully."}),b&&b())};return e.jsxs("div",{className:"max-w-xl mx-auto mt-10 p-6 bg-card text-card-foreground rounded shadow",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Edit Profile"}),e.jsxs("form",{onSubmit:_,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("img",{src:p||"/default-avatar.png",alt:"Avatar",className:"w-20 h-20 rounded-full object-cover border-2 border-primary shadow"}),e.jsx(N,{type:"button",size:"sm",className:"mt-2 bg-primary text-primary-foreground rounded-full px-4 py-1",onClick:()=>x.current?.click(),disabled:c,children:p?"Change":"Upload"}),e.jsx("input",{ref:x,type:"file",accept:"image/*",className:"hidden",onChange:y,disabled:c})]}),e.jsxs("div",{className:"mb-14",children:[e.jsx("div",{className:"font-semibold text-foreground",children:a?.username}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t.email})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium text-foreground",children:"Full Name"}),e.jsx(i,{name:"full_name",value:t.full_name,onChange:r})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium text-foreground",children:"Bio"}),e.jsx("textarea",{name:"bio",value:t.bio,onChange:r,className:"w-full border rounded px-3 py-2 bg-background text-foreground border-border",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium text-foreground",children:"Location"}),e.jsx(i,{name:"location",value:t.location,onChange:r})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium text-foreground",children:"Twitter"}),e.jsx(i,{name:"twitter",value:t.twitter,onChange:r,placeholder:"https://twitter.com/yourhandle"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium text-foreground",children:"LinkedIn"}),e.jsx(i,{name:"linkedin",value:t.linkedin,onChange:r,placeholder:"https://linkedin.com/in/yourprofile"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium text-foreground",children:"Facebook"}),e.jsx(i,{name:"facebook",value:t.facebook,onChange:r,placeholder:"https://facebook.com/yourprofile"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium text-foreground",children:"Website"}),e.jsx(i,{name:"website",value:t.website,onChange:r,placeholder:"https://yourwebsite.com"})]}),e.jsx(N,{type:"submit",className:"bg-primary text-primary-foreground",disabled:c,children:c?"Saving...":"Save Changes"})]})]})};export{D as default};
