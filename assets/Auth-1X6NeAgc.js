import{j as e}from"./ui-JykPZCXU.js";import{r as o}from"./vendor-o8UMtg5z.js";import{I as p,B as U}from"./input-DSoQLqVb.js";import{L as x}from"./label-R1kRSnQb.js";import{C as k,b as E,c as F,d as L,a as J}from"./card-BPC4h2rA.js";import{a as M,L as I}from"./router-DZ6VJzti.js";import{c as O,p as q,u as z}from"./index-DOD6g3cj.js";import{c as X}from"./supabase-DllsxF6L.js";import{A as B}from"./arrow-left-ZkvyHdYd.js";import{E as Y}from"./eye-CroIoA9q.js";import"./utils-Bsf8JV-l.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=O("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),G="https://ryzskohhsqryyjuzcpif.supabase.co",W="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ5enNrb2hoc3FyeXlqdXpjcGlmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg3NjE3NjMsImV4cCI6MjA2NDMzNzc2M30.rOPQoqfEvXT4P1irUa7mRPPIHMZKDilo7Nby029688s",l=X(G,W),A={async signUp(r){try{const{available:s,error:a}=await q.isUsernameAvailable(r.username);if(a)return{data:null,error:a};if(!s)return{data:null,error:"Username is already taken"};const{data:u,error:n}=await l.auth.signUp({email:r.email,password:r.password,options:{data:{username:r.username,full_name:r.fullName||""}}});return n?(console.error("Auth signup error:",n),{data:null,error:n.message}):u.user?{data:{user:u.user,session:u.session},error:null}:{data:null,error:"Failed to create user"}}catch(s){return console.error("Unexpected signup error:",s),{data:null,error:"An unexpected error occurred during signup"}}},async signIn(r){try{const{data:s,error:a}=await l.auth.signInWithPassword({email:r.email,password:r.password});return a?(console.error("Sign in error:",a),{data:null,error:a.message}):{data:s,error:null}}catch(s){return console.error("Unexpected sign in error:",s),{data:null,error:"An unexpected error occurred during sign in"}}},async signOut(){try{const{error:r}=await l.auth.signOut();return r?(console.error("Sign out error:",r),{error:r.message}):{error:null}}catch(r){return console.error("Unexpected sign out error:",r),{error:"An unexpected error occurred during sign out"}}},async getCurrentSession(){try{const{data:{session:r},error:s}=await l.auth.getSession();return s?(console.error("Get session error:",s),{session:null,error:s.message}):{session:r,error:null}}catch(r){return console.error("Unexpected get session error:",r),{session:null,error:"An unexpected error occurred"}}},async getCurrentUser(){try{const{data:{user:r},error:s}=await l.auth.getUser();return s?(console.error("Get user error:",s),{user:null,error:s.message}):{user:r,error:null}}catch(r){return console.error("Unexpected get user error:",r),{user:null,error:"An unexpected error occurred"}}},onAuthStateChange(r){return l.auth.onAuthStateChange(r)}},se=()=>{const[r,s]=o.useState(!0),[a,u]=o.useState(!1),[n,g]=o.useState(""),[f,y]=o.useState(""),[j,N]=o.useState(""),[d,b]=o.useState(""),[v,w]=o.useState(""),[C,m]=o.useState(!1),S=M(),{toast:i}=z(),P=async t=>{t.preventDefault(),m(!0);try{if(r){const{data:c,error:h}=await A.signIn({email:n,password:f});if(h)throw new Error(h);c.user&&(i({title:"Welcome back!",description:"You've successfully logged in."}),S("/dashboard"))}else{if(f!==j){i({title:"Password mismatch",description:"Please make sure your passwords match.",variant:"destructive"}),m(!1);return}if(!d.trim()){i({title:"Username required",description:"Please enter a username.",variant:"destructive"}),m(!1);return}if(d.length<3){i({title:"Username too short",description:"Username must be at least 3 characters long.",variant:"destructive"}),m(!1);return}const{data:c,error:h}=await A.signUp({email:n,password:f,username:d.trim(),fullName:v.trim()||void 0});if(h)throw new Error(h);c.user&&(i({title:"Account created!",description:`Welcome to NearNest, ${d}! You can now start exploring after verifying your accout. Please check you email.`}),S("/dashboard"))}}catch(c){console.error("Authentication error:",c),i({title:"Authentication failed",description:c.message||"Please try again.",variant:"destructive"})}finally{m(!1)}};return e.jsx("div",{className:"min-h-screen bg-background text-foreground flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsx("div",{className:"mb-6",children:e.jsxs(I,{to:"/",className:"inline-flex items-center text-primary hover:text-primary/80 transition-colors",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Back to Home"]})}),e.jsxs(k,{className:"shadow-2xl border-0",children:[e.jsxs(E,{className:"space-y-1 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-primary rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-primary-foreground font-bold text-lg",children:"N"})}),e.jsx("span",{className:"text-2xl font-bold text-foreground",children:"NearNest"})]}),e.jsx(F,{className:"text-2xl font-bold",children:r?"Welcome Back":"Create Account"}),e.jsx(L,{children:r?"Sign in to your account to continue":"Join your neighborhood community today"})]}),e.jsxs(J,{children:[e.jsxs("form",{onSubmit:P,className:"space-y-4",children:[!r&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2 animate-fade-in",children:[e.jsx(x,{htmlFor:"username",children:"Username"}),e.jsx(p,{id:"username",type:"text",placeholder:"Choose a username",value:d,onChange:t=>b(t.target.value),required:!0,minLength:3,maxLength:30,pattern:"^[a-zA-Z0-9_]+$",title:"Username can only contain letters, numbers, and underscores",className:"border-border focus:border-primary focus:ring-primary"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"3-30 characters, letters, numbers, and underscores only"})]}),e.jsxs("div",{className:"space-y-2 animate-fade-in",children:[e.jsx(x,{htmlFor:"fullName",children:"Full Name (Optional)"}),e.jsx(p,{id:"fullName",type:"text",placeholder:"Your full name",value:v,onChange:t=>w(t.target.value),className:"border-border focus:border-primary focus:ring-primary"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"email",children:"Email"}),e.jsx(p,{id:"email",type:"email",placeholder:"your@email.com",value:n,onChange:t=>g(t.target.value),required:!0,className:"border-border focus:border-primary focus:ring-primary"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(p,{id:"password",type:a?"text":"password",placeholder:"Enter your password",value:f,onChange:t=>y(t.target.value),required:!0,minLength:6,className:"border-border focus:border-primary focus:ring-primary pr-10"}),e.jsx("button",{type:"button",onClick:()=>u(!a),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground",children:a?e.jsx(Z,{className:"h-4 w-4"}):e.jsx(Y,{className:"h-4 w-4"})})]})]}),!r&&e.jsxs("div",{className:"space-y-2 animate-fade-in",children:[e.jsx(x,{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsx("div",{className:"relative",children:e.jsx(p,{id:"confirmPassword",type:a?"text":"password",placeholder:"Confirm your password",value:j,onChange:t=>N(t.target.value),required:!0,className:"border-border focus:border-primary focus:ring-primary"})})]}),e.jsx(U,{type:"submit",className:"w-full bg-primary hover:bg-accent text-primary-foreground py-3 text-lg font-medium transition-all duration-200 hover:scale-[1.02]",disabled:C,children:C?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary-foreground"}),e.jsx("span",{children:r?"Signing In...":"Creating Account..."})]}):r?"Sign In":"Create Account"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:[r?"Don't have an account?":"Already have an account?",e.jsx("button",{onClick:()=>{s(!r),g(""),y(""),N(""),b(""),w("")},className:"ml-1 text-primary hover:text-primary/80 font-medium",children:r?"Sign up":"Sign in"})]})}),r&&e.jsx("div",{className:"mt-4 text-center",children:e.jsx(I,{to:"/forgot-password",className:"text-sm text-primary hover:text-primary/80",children:"Forgot your password?"})})]})]})]})})};export{se as default};
